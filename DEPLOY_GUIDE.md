# üöÄ GUIA COMPLETO DE DEPLOY - QOTA FINANCE

Este guia vai te ensinar a colocar seu projeto **100% NO AR DE FORMA GRATUITA**!

---

## üìã O QUE VOC√ä VAI PRECISAR

1. ‚úÖ Dom√≠nio qotastore.lol (voc√™ j√° tem!)
2. ‚úÖ Conta no GitHub (vamos criar se voc√™ n√£o tiver)
3. ‚úÖ Conta no Render.com (gratuito - vamos criar)
4. ‚úÖ Conta no Vercel (gratuito - vamos criar)
5. ‚úÖ 30-40 minutos do seu tempo

---

## üéØ VIS√ÉO GERAL

Vamos fazer isso em 7 etapas:

```
1. Subir c√≥digo para GitHub
2. Criar banco de dados PostgreSQL gratuito (Render)
3. Fazer deploy do Backend (Render)
4. Fazer deploy do Frontend (Vercel)
5. Configurar dom√≠nio qotastore.lol
6. Testar tudo funcionando
7. Ajustes finais
```

---

# PARTE 1: GITHUB (15 minutos)

## Passo 1.1 - Criar conta no GitHub (se n√£o tiver)

1. Acesse: https://github.com/signup
2. Preencha com seu email
3. Crie uma senha forte
4. Escolha um username
5. Verifique seu email
6. ‚úÖ Pronto! Conta criada

## Passo 1.2 - Criar reposit√≥rio

1. Acesse: https://github.com/new
2. Preencha:
   - **Repository name**: `qota-finance`
   - **Description**: `Sistema de controle financeiro FBA Amazon`
   - **Visibility**: Marque **Public** (necess√°rio para planos gratuitos)
3. **N√ÉO marque** "Add a README file"
4. Clique em **"Create repository"**
5. ‚úÖ Reposit√≥rio criado!

## Passo 1.3 - Subir c√≥digo para o GitHub

Abra o terminal na pasta do projeto e execute estes comandos **UM POR VEZ**:

```bash
# 1. Inicializar git (se ainda n√£o foi inicializado)
git init

# 2. Adicionar todos os arquivos
git add .

# 3. Fazer primeiro commit
git commit -m "Initial commit - Qota Finance"

# 4. Adicionar o reposit√≥rio remoto
# ‚ö†Ô∏è ATEN√á√ÉO: Substitua 'SEU-USERNAME' pelo seu username do GitHub!
git remote add origin https://github.com/SEU-USERNAME/qota-finance.git

# 5. Enviar c√≥digo para o GitHub
git branch -M master
git push -u origin master
```

**Ele vai pedir seu username e senha do GitHub. Digite e aperte Enter.**

> üí° **DICA**: Se pedir token ao inv√©s de senha:
> - V√° em: https://github.com/settings/tokens
> - Clique em "Generate new token (classic)"
> - Selecione "repo"
> - Clique em "Generate token"
> - Copie o token e use como senha

‚úÖ **C√≥digo agora est√° no GitHub!**

---

# PARTE 2: BANCO DE DADOS (10 minutos)

## Passo 2.1 - Criar conta no Render

1. Acesse: https://render.com/
2. Clique em **"Get Started for Free"**
3. Escolha **"Sign up with GitHub"** (mais f√°cil!)
4. Autorize o Render a acessar sua conta GitHub
5. ‚úÖ Conta criada!

## Passo 2.2 - Criar banco de dados PostgreSQL

1. No dashboard do Render, clique em **"New +"** (canto superior direito)
2. Selecione **"PostgreSQL"**
3. Preencha:
   - **Name**: `qota-finance-db`
   - **Database**: `qota_finance`
   - **User**: `qota_user` (ou deixe o padr√£o)
   - **Region**: Escolha **"Frankfurt (EU Central)"** (mais pr√≥ximo)
   - **PostgreSQL Version**: Deixe a vers√£o mais recente
   - **Plan**: Selecione **"Free"** üéâ
4. Clique em **"Create Database"**
5. **AGUARDE 2-3 minutos** enquanto o banco √© criado
6. ‚úÖ Banco de dados criado!

## Passo 2.3 - Copiar credenciais do banco

1. Na p√°gina do banco de dados, role at√© **"Connections"**
2. Voc√™ ver√° v√°rias informa√ß√µes. **COPIE** e salve em um bloco de notas:
   - **Internal Database URL** (vamos usar essa!)
   - Deve ser algo como: `postgresql://usuario:senha@host/database`

‚ö†Ô∏è **IMPORTANTE**: Guarde essa URL! Vamos usar em breve.

---

# PARTE 3: DEPLOY DO BACKEND (15 minutos)

## Passo 3.1 - Criar Web Service no Render

1. No dashboard do Render, clique em **"New +"**
2. Selecione **"Web Service"**
3. Clique em **"Connect a repository"**
4. Se n√£o aparecer seu reposit√≥rio:
   - Clique em **"Configure account"**
   - Autorize o Render a acessar seus reposit√≥rios
   - Selecione **"Only select repositories"**
   - Escolha **"qota-finance"**
   - Clique em **"Install"**
5. Agora selecione o reposit√≥rio **"qota-finance"**
6. ‚úÖ Reposit√≥rio conectado!

## Passo 3.2 - Configurar o Backend

Preencha os campos:

- **Name**: `qota-finance-api`
- **Region**: **"Frankfurt (EU Central)"** (mesma do banco!)
- **Branch**: `master`
- **Root Directory**: `backend` ‚ö†Ô∏è IMPORTANTE!
- **Runtime**: **"Node"**
- **Build Command**:
  ```
  npm install && npm run build
  ```
- **Start Command**:
  ```
  npm start
  ```
- **Plan**: Selecione **"Free"** üéâ

## Passo 3.3 - Configurar Vari√°veis de Ambiente

Role at√© **"Environment Variables"** e adicione:

Clique em **"Add Environment Variable"** para cada uma:

1. **NODE_ENV**
   - Value: `production`

2. **PORT**
   - Value: `8000`

3. **DATABASE_URL**
   - Value: Cole aqui a **Internal Database URL** que voc√™ copiou antes
   - Exemplo: `postgresql://qota_user:senha123@dpg-xxxxx.frankfurt-postgres.render.com/qota_finance`

4. **ALLOWED_ORIGINS**
   - Value: `https://qotastore.lol,https://www.qotastore.lol`
   - (vamos adicionar a URL da Vercel depois)

5. **JWT_SECRET**
   - Value: Crie uma senha aleat√≥ria forte, exemplo: `minhaSenhaSecreta123!@#QotaStore2025`

## Passo 3.4 - Fazer Deploy

1. Clique em **"Create Web Service"** (bot√£o verde no final da p√°gina)
2. **AGUARDE 5-10 minutos** - O Render vai:
   - Baixar seu c√≥digo
   - Instalar depend√™ncias
   - Compilar TypeScript
   - Iniciar servidor
3. Voc√™ ver√° logs aparecendo na tela
4. Quando aparecer **"Deploy live ‚úÖ"** est√° pronto!

## Passo 3.5 - Executar Migrations do Banco

1. Na p√°gina do seu servi√ßo, clique na aba **"Shell"** (menu lateral esquerdo)
2. Se n√£o tiver "Shell", clique em **"Events"** e aguarde o deploy terminar
3. Depois que o deploy terminar, v√° em **"Shell"**
4. Digite este comando e aperte Enter:
   ```bash
   npm run migrate
   ```
5. Aguarde at√© aparecer "‚úÖ Todas as migrations foram executadas!"
6. ‚úÖ Banco de dados configurado!

## Passo 3.6 - Testar Backend

1. No topo da p√°gina do servi√ßo, voc√™ ver√° uma URL tipo:
   - `https://qota-finance-api.onrender.com`
2. **COPIE** essa URL
3. Abra no navegador: `https://qota-finance-api.onrender.com/health`
4. Deve aparecer algo como:
   ```json
   {
     "status": "ok",
     "timestamp": "2025-10-21T...",
     "uptime": 123.45
   }
   ```
5. ‚úÖ Backend funcionando!

‚ö†Ô∏è **GUARDE ESSA URL** - vamos usar no frontend!

---

# PARTE 4: DEPLOY DO FRONTEND (10 minutos)

## Passo 4.1 - Criar conta na Vercel

1. Acesse: https://vercel.com/signup
2. Clique em **"Continue with GitHub"**
3. Autorize a Vercel
4. ‚úÖ Conta criada!

## Passo 4.2 - Importar Projeto

1. No dashboard da Vercel, clique em **"Add New..."**
2. Selecione **"Project"**
3. Na lista, encontre **"qota-finance"**
4. Clique em **"Import"**

## Passo 4.3 - Configurar Frontend

Preencha:

- **Project Name**: `qota-finance`
- **Framework Preset**: Selecione **"Angular"**
- **Root Directory**: Clique em **"Edit"** e digite `frontend`
- **Build Command**: Deixe o padr√£o `npm run build`
- **Output Directory**: `dist/frontend`

## Passo 4.4 - N√ÉO adicione vari√°veis de ambiente ainda

1. Role at√© o final
2. Clique em **"Deploy"** (bot√£o azul)
3. **AGUARDE 3-5 minutos**
4. Quando aparecer a anima√ß√£o de confete üéâ, est√° pronto!

## Passo 4.5 - Atualizar URL do Backend no c√≥digo

Agora precisamos atualizar a URL da API no frontend:

1. **Volte para o terminal** na sua m√°quina
2. Abra o arquivo de produ√ß√£o:
   ```bash
   # Edite o arquivo (use seu editor favorito, vim, nano, vscode, etc)
   # O arquivo est√° em: frontend/src/environments/environment.prod.ts
   ```

3. Altere para:
   ```typescript
   export const environment = {
     production: true,
     apiUrl: 'https://SUA-URL-DO-RENDER.onrender.com/api',
     wsUrl: 'wss://SUA-URL-DO-RENDER.onrender.com'
   };
   ```

   ‚ö†Ô∏è **Substitua** `SUA-URL-DO-RENDER.onrender.com` pela URL que voc√™ copiou antes!

   Exemplo:
   ```typescript
   export const environment = {
     production: true,
     apiUrl: 'https://qota-finance-api.onrender.com/api',
     wsUrl: 'wss://qota-finance-api.onrender.com'
   };
   ```

4. Salve o arquivo

5. No terminal, execute:
   ```bash
   git add .
   git commit -m "Update production API URL"
   git push
   ```

6. A Vercel vai detectar automaticamente e fazer **re-deploy** (2-3 minutos)

## Passo 4.6 - Pegar URL do Frontend

1. Volte para o dashboard da Vercel
2. Voc√™ ver√° uma URL tipo: `https://qota-finance.vercel.app`
3. **COPIE** essa URL
4. Clique nela para testar - seu site deve abrir! üéâ

---

# PARTE 5: ATUALIZAR CORS NO BACKEND (5 minutos)

Agora precisamos permitir que o frontend acesse o backend:

## Passo 5.1 - Adicionar URL do Frontend no CORS

1. Volte para o **Render.com**
2. Acesse seu servi√ßo **"qota-finance-api"**
3. No menu lateral, clique em **"Environment"**
4. Encontre a vari√°vel **"ALLOWED_ORIGINS"**
5. Clique em **"Edit"** (l√°pis)
6. **ADICIONE** a URL da Vercel separada por v√≠rgula:
   ```
   https://qotastore.lol,https://www.qotastore.lol,https://qota-finance.vercel.app
   ```
7. Clique em **"Save Changes"**
8. O servi√ßo vai reiniciar automaticamente (1-2 minutos)

‚úÖ Agora frontend e backend podem se comunicar!

---

# PARTE 6: CONFIGURAR DOM√çNIO qotastore.lol (15 minutos)

## Passo 6.1 - Configurar DNS no Porkbun

1. Acesse: https://porkbun.com/account/domainsSpeedy
2. Clique no dom√≠nio **"qotastore.lol"**
3. Clique na aba **"DNS Records"**
4. **DELETE todos os registros existentes** (se houver)

## Passo 6.2 - Adicionar registros DNS para o Frontend (Vercel)

Vamos adicionar 2 registros para apontar seu dom√≠nio para a Vercel:

**Registro 1 - CNAME para www:**
- Clique em **"Add Record"**
- **Type**: `CNAME`
- **Host**: `www`
- **Answer**: `cname.vercel-dns.com`
- **TTL**: `600`
- Clique em **"Add"**

**Registro 2 - A para dom√≠nio raiz:**
- Clique em **"Add Record"**
- **Type**: `A`
- **Host**: deixe vazio ou digite `@`
- **Answer**: `76.76.21.21` (IP da Vercel)
- **TTL**: `600`
- Clique em **"Add"**

**Registro 3 - Outro A para dom√≠nio raiz (failover):**
- Clique em **"Add Record"**
- **Type**: `A`
- **Host**: deixe vazio ou digite `@`
- **Answer**: `76.76.21.142`
- **TTL**: `600`
- Clique em **"Add"**

‚úÖ DNS configurado!

## Passo 6.3 - Adicionar dom√≠nio customizado na Vercel

1. Volte para o **dashboard da Vercel**
2. Clique no projeto **"qota-finance"**
3. Clique na aba **"Settings"** (menu superior)
4. No menu lateral, clique em **"Domains"**
5. No campo, digite: `qotastore.lol`
6. Clique em **"Add"**
7. A Vercel vai verificar o DNS (pode levar alguns minutos)
8. Adicione tamb√©m o `www`:
   - Digite: `www.qotastore.lol`
   - Clique em **"Add"**
9. Configure redirecionamento:
   - Em `www.qotastore.lol`, clique em **"Edit"**
   - Marque **"Redirect to qotastore.lol"**
   - Salve

## Passo 6.4 - Aguardar propaga√ß√£o DNS

‚è∞ **ISSO PODE LEVAR AT√â 24 HORAS**, mas geralmente demora 15-30 minutos.

Para verificar:
1. Abra o navegador em modo an√¥nimo
2. Tente acessar: `https://qotastore.lol`
3. Se n√£o funcionar, aguarde mais um pouco ‚òï

Enquanto isso, voc√™ pode usar: `https://qota-finance.vercel.app`

---

# PARTE 7: TESTES FINAIS (10 minutos)

## Checklist de testes:

- [ ] Backend funcionando: `https://qota-finance-api.onrender.com/health`
- [ ] Frontend Vercel: `https://qota-finance.vercel.app`
- [ ] Dom√≠nio customizado: `https://qotastore.lol`
- [ ] Frontend consegue se comunicar com backend (testa as funcionalidades)
- [ ] Banco de dados salvando informa√ß√µes

## Se algo n√£o funcionar:

### Problema: "CORS error" no console do navegador

**Solu√ß√£o**:
1. V√° no Render > qota-finance-api > Environment
2. Verifique se ALLOWED_ORIGINS tem TODAS as URLs:
   ```
   https://qotastore.lol,https://www.qotastore.lol,https://qota-finance.vercel.app
   ```
3. Salve e aguarde reiniciar

### Problema: Backend n√£o inicia / erro no Render

**Solu√ß√£o**:
1. V√° em Render > qota-finance-api > Logs
2. Verifique os erros
3. Geralmente √© problema de vari√°vel de ambiente
4. Confira se DATABASE_URL est√° correta

### Problema: Frontend com tela branca

**Solu√ß√£o**:
1. Abra o console do navegador (F12)
2. Veja os erros
3. Verifique se a URL da API est√° correta em `environment.prod.ts`

### Problema: Dom√≠nio n√£o funciona

**Solu√ß√£o**:
1. Aguarde mais tempo (at√© 24h)
2. Verifique DNS em: https://dnschecker.org/
   - Digite: `qotastore.lol`
   - Veja se os registros A e CNAME aparecem
3. Se ap√≥s 24h n√£o funcionar, confira os registros DNS no Porkbun

---

# üéâ PARAB√âNS!

Seu sistema est√° no ar!

## URLs finais:

- **Site**: https://qotastore.lol
- **API**: https://qota-finance-api.onrender.com
- **Banco**: Gerenciado pelo Render

## üìä Monitoramento:

- **Render**: https://dashboard.render.com - para ver logs do backend e banco
- **Vercel**: https://vercel.com/dashboard - para ver logs do frontend

## ‚ö†Ô∏è AVISOS IMPORTANTES:

### Plano Gratuito do Render:
- Ap√≥s **15 minutos de inatividade**, o servidor "hiberna" (dorme)
- Na pr√≥xima visita, pode demorar **30-60 segundos** para "acordar"
- Se quiser evitar isso, fa√ßa upgrade para plano pago ($7/m√™s)

### Plano Gratuito da Vercel:
- Sem limita√ß√µes significativas para sites pequenos
- At√© 100GB de bandwidth por m√™s

### Banco de dados gratuito do Render:
- **90 dias de dura√ß√£o**
- Depois precisa migrar para plano pago ($7/m√™s) ou outro servi√ßo
- **Alternativa gratuita permanente**: Neon.tech (https://neon.tech) - 0.5GB gr√°tis para sempre

---

## üîÑ ATUALIZA√á√ïES FUTURAS

Quando voc√™ alterar o c√≥digo:

### Backend:
```bash
git add .
git commit -m "Descri√ß√£o da altera√ß√£o"
git push
```
O Render detecta automaticamente e faz re-deploy!

### Frontend:
```bash
git add .
git commit -m "Descri√ß√£o da altera√ß√£o"
git push
```
A Vercel detecta automaticamente e faz re-deploy!

---

## üÜò PRECISA DE AJUDA?

- **Render Docs**: https://render.com/docs
- **Vercel Docs**: https://vercel.com/docs
- **Porkbun Support**: https://porkbun.com/support

---

**Boa sorte! üöÄ**
