<div class="dashboard">
  <!-- Saldo Amazon com botÃ£o de refresh -->
  <div class="amazon-balance-card">
    <div class="amazon-icon">ğŸ›’</div>
    <div class="amazon-content">
      <div class="amazon-label">
        SALDO AMAZON (DISPONÃVEL) â€” USD
      </div>
      <div class="amazon-value">
        {{ formatUSD(saldo?.disponivel) }}
      </div>
      <div class="amazon-actions">
        <button
          class="btn-refresh"
          (click)="refreshSaldoAmazon()"
          [disabled]="refreshingSaldo">
          <span *ngIf="!refreshingSaldo">ğŸ”„ Atualizar da API</span>
          <span *ngIf="refreshingSaldo">â³ Atualizando...</span>
        </button>

        <button
          class="btn-sync"
          (click)="syncAmazonOrders()"
          [disabled]="loading">
          ğŸ“¥ Sincronizar Vendas
        </button>
      </div>
    </div>
  </div>

  <!-- Auto-refresh info -->
  <div class="auto-refresh-bar" *ngIf="autoRefreshEnabled">
    <span>ğŸ”„ Auto-atualizaÃ§Ã£o ativa</span>
    <span class="countdown">PrÃ³xima em: {{ formatTime(nextRefreshIn) }}</span>
    <button class="btn-toggle" (click)="toggleAutoRefresh()">
      {{ autoRefreshEnabled ? 'â¸ï¸ Pausar' : 'â–¶ï¸ Ativar' }}
    </button>
  </div>

  <!-- Resumo do MÃªs -->
  <h3 class="section-title">
    Resumo do MÃªs â€” {{ getMonthLabel(currentMonth) }}
  </h3>

  <div class="kpi-grid">
    <!-- Receitas -->
    <div class="kpi-card receita">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ“ˆ</div>
        <div>
          <div class="kpi-label">Receitas (mÃªs)</div>
          <div class="kpi-value-usd green">USD: {{ formatUSD(resumoMes?.recUSD) }}</div>
          <div class="kpi-value-brl green">BRL: {{ formatBRL(resumoMes?.recBRL) }}</div>
        </div>
      </div>
    </div>

    <!-- Despesas -->
    <div class="kpi-card despesa">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ“‰</div>
        <div>
          <div class="kpi-label">Despesas (mÃªs)</div>
          <div class="kpi-value-usd red">USD: {{ formatUSD(resumoMes?.despUSD) }}</div>
          <div class="kpi-value-brl red">BRL: {{ formatBRL(resumoMes?.despBRL) }}</div>
        </div>
      </div>
    </div>

    <!-- Resultado -->
    <div class="kpi-card resultado">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ’°</div>
        <div>
          <div class="kpi-label">Resultado (mÃªs)</div>
          <div class="kpi-value-usd" [ngClass]="getResultClass(resultadoMesUSD)">
            USD: {{ formatUSD(resultadoMesUSD) }}
          </div>
          <div class="kpi-value-brl" [ngClass]="getResultClass(resultadoMesBRL)">
            BRL: {{ formatBRL(resultadoMesBRL) }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <hr class="divider">

  <!-- Totais Acumulados -->
  <h3 class="section-title">
    Valor Total â€” Somas de Todos os Meses
  </h3>

  <div class="kpi-grid">
    <div class="kpi-card receita">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ“Š</div>
        <div>
          <div class="kpi-label">Receitas (total)</div>
          <div class="kpi-value-usd green">USD: {{ formatUSD(totais?.recUSD) }}</div>
          <div class="kpi-value-brl green">BRL: {{ formatBRL(totais?.recBRL) }}</div>
        </div>
      </div>
    </div>

    <div class="kpi-card despesa">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ’¸</div>
        <div>
          <div class="kpi-label">Despesas (total)</div>
          <div class="kpi-value-usd red">USD: {{ formatUSD(totais?.despUSD) }}</div>
          <div class="kpi-value-brl red">BRL: {{ formatBRL(totais?.despBRL) }}</div>
        </div>
      </div>
    </div>

    <div class="kpi-card resultado">
      <div class="kpi-content">
        <div class="kpi-icon">ğŸ¯</div>
        <div>
          <div class="kpi-label">Resultado (total)</div>
          <div class="kpi-value-usd" [ngClass]="getResultClass(resultadoTotalUSD)">
            USD: {{ formatUSD(resultadoTotalUSD) }}
          </div>
          <div class="kpi-value-brl" [ngClass]="getResultClass(resultadoTotalBRL)">
            BRL: {{ formatBRL(resultadoTotalBRL) }}
          </div>
        </div>
      </div>
    </div>
  </div>

  <hr class="divider">

  <!-- Lucros -->
  <h3 class="section-title">Lucros</h3>

  <div class="lucros-grid">
    <div class="lucro-card">
      <div class="lucro-icon">ğŸ“ˆ</div>
      <div>
        <div class="lucro-label">
          Lucro realizado no perÃ­odo â€” {{ getMonthLabel(currentMonth) }}
        </div>
        <div class="lucro-value">
          {{ formatUSD(lucros?.lucroPeriodo) }}
        </div>
      </div>
    </div>

    <div class="lucro-card">
      <div class="lucro-icon">ğŸ’</div>
      <div>
        <div class="lucro-label">
          Lucro TOTAL â€” soma de todos os meses
        </div>
        <div class="lucro-value">
          {{ formatUSD(lucros?.lucroTotal) }}
        </div>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p class="loading-text">Carregando dados...</p>
  </div>
</div>
